<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/ovn-kubernetes/assets/css/style.css?v=9e6c62f21184b23c5bdbecd995abe5f149115b0f" media="screen" type="text/css">
    <link rel="stylesheet" href="/ovn-kubernetes/assets/css/print.css" media="print" type="text/css">

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Metrics | OVN-Kubernetes Homepage</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Metrics" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="test" />
<meta property="og:description" content="test" />
<link rel="canonical" href="http://www.ovn.org/ovn-kubernetes/metrics.html" />
<meta property="og:url" content="http://www.ovn.org/ovn-kubernetes/metrics.html" />
<meta property="og:site_name" content="OVN-Kubernetes Homepage" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Metrics" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"test","headline":"Metrics","url":"http://www.ovn.org/ovn-kubernetes/metrics.html"}</script>
<!-- End Jekyll SEO tag -->


    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/ovn-kubernetes/favicon.ico" -->

<!-- end custom head snippets -->

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="http://www.ovn.org/ovn-kubernetes/">
          <h1>OVN-Kubernetes Homepage</h1>
        </a>
        <h2>test</h2>
        
          <a href="https://github.com/ovn-org/ovn-kubernetes" class="button"><small>View project on</small> GitHub</a>
        
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1 id="metrics">Metrics</h1>
<h2 id="ovn-kubernetes-master">OVN-Kubernetes master</h2>
<p>This includes a description of a selective set of metrics and to explore the exhausted set, see <code class="language-plaintext highlighter-rouge">go-controller/pkg/metrics/master.go</code></p>
<h3 id="configuration-duration-recorder">Configuration duration recorder</h3>
<h4 id="setup">Setup</h4>
<p>Enabled by default with the <code class="language-plaintext highlighter-rouge">kind.sh</code> (in directory <code class="language-plaintext highlighter-rouge">$ROOT/contrib</code>) <a href="https://kind.sigs.k8s.io/">Kind</a> setup script.
Disabled by default for binary ovnkube-master and enabled with flag <code class="language-plaintext highlighter-rouge">--metrics-enable-config-duration</code>.</p>
<h4 id="high-level-description">High-level description</h4>
<p>This set of metrics gives a result for the upper bound duration which means, it has taken at most this amount of seconds to apply the configuration to all nodes. It does not represent the exact accurate time to apply only this configuration.
Measurement accuracy can be impacted by other parallel processing that might be occurring while the measurement is in progress therefore, the accuracy of the measurements should only indicate upper bound duration to roll out configuration changes.</p>
<h4 id="metrics-1">Metrics</h4>
<p>| Name | Prometheus type | Description  |
|–|–|–|
|ovnkube_master_network_programming_duration_seconds | Histogram | The duration to apply network configuration for a kind (e.g. pod, service, networkpolicy). Configuration includes add, update and delete events for kinds. This includes OVN-Kubernetes master and OVN duration.
|ovnkube_master_network_programming_ovn_duration_seconds| Histogram  | The duration for OVN to apply network configuration for a kind (e.g. pod, service, networkpolicy).</p>

<h2 id="change-log">Change log</h2>
<p>This list is to help notify if there are additions, changes or removals to metrics. Latest changes are at the top of this list.</p>

<ul>
  <li>Add metrics to track logfile size for ovnkube processes - ovnkube_node_logfile_size_bytes and ovnkube_controller_logfile_size_bytes</li>
  <li>Remove ovnkube_controller_ovn_cli_latency_seconds metrics since we have moved most of the OVN DB operations to libovsdb.</li>
  <li>Effect of OVN IC architecture:
    <ul>
      <li>Move all the metrics from subsystem “ovnkube-master” to subsystem “ovnkube-controller”. The non-IC and IC deployments will each continue to have their ovnkube-master and ovnkube-controller containers running inside the ovnkube-master and ovnkube-controller pods. The metrics scraping should work seemlessly. See https://github.com/ovn-org/ovn-kubernetes/pull/3723 for details</li>
      <li>Move the following metrics from subsystem “master” to subsystem “clustermanager”. Therefore, the follow metrics are renamed.
        <ul>
          <li><code class="language-plaintext highlighter-rouge">ovnkube_master_num_v4_host_subnets</code> -&gt; <code class="language-plaintext highlighter-rouge">ovnkube_clustermanager_num_v4_host_subnets</code></li>
          <li><code class="language-plaintext highlighter-rouge">ovnkube_master_num_v6_host_subnets</code> -&gt; <code class="language-plaintext highlighter-rouge">ovnkube_clustermanager_num_v6_host_subnets</code></li>
          <li><code class="language-plaintext highlighter-rouge">ovnkube_master_allocated_v4_host_subnets</code> -&gt; <code class="language-plaintext highlighter-rouge">ovnkube_clustermanager_allocated_v4_host_subnets</code></li>
          <li><code class="language-plaintext highlighter-rouge">ovnkube_master_allocated_v6_host_subnets</code> -&gt; <code class="language-plaintext highlighter-rouge">ovnkube_clustermanager_allocated_v6_host_subnets</code></li>
          <li><code class="language-plaintext highlighter-rouge">ovnkube_master_num_egress_ips</code> -&gt; <code class="language-plaintext highlighter-rouge">ovnkube_clustermanager_num_egress_ips</code></li>
          <li><code class="language-plaintext highlighter-rouge">ovnkube_master_egress_ips_node_unreachable_total</code> -&gt; <code class="language-plaintext highlighter-rouge">ovnkube_clustermanager_egress_ips_node_unreachable_total</code></li>
          <li><code class="language-plaintext highlighter-rouge">ovnkube_master_egress_ips_rebalance_total</code> -&gt; <code class="language-plaintext highlighter-rouge">ovnkube_clustermanager_egress_ips_rebalance_total</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Update description of ovnkube_master_pod_creation_latency_seconds</li>
  <li>Add libovsdb metrics - ovnkube_master_libovsdb_disconnects_total and ovnkube_master_libovsdb_monitors.</li>
  <li>Add ovn_controller_southbound_database_connected metric (https://github.com/ovn-org/ovn-kubernetes/pull/3117).</li>
  <li>Stopwatch metrics now report in seconds instead of milliseconds.</li>
  <li>Rename (https://github.com/ovn-org/ovn-kubernetes/pull/3022):
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_link_resets</code> -&gt; <code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_resets_total</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_rx_dropped</code> -&gt; <code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_rx_dropped_total</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_tx_dropped</code> -&gt; <code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_tx_dropped_total</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_rx_errors</code> -&gt; <code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_rx_errors_total</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_tx_errors</code> -&gt; <code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_tx_errors_total</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_collisions</code> -&gt; <code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_collisions_total</code></li>
    </ul>
  </li>
  <li>Remove (https://github.com/ovn-org/ovn-kubernetes/pull/3022):
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_dp_if</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_driver_name</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_driver_version</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_firmware_version</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_rx_packets</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_tx_packets</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_rx_bytes</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_tx_bytes</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_rx_frame_err</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_rx_over_err</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_rx_crc_err</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_name</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_duplex</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_type</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_admin_state</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_link_state</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_ifindex</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_link_speed</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_mtu</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_ofport</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_ingress_policing_burst</code></li>
      <li><code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_ingress_policing_rate</code></li>
    </ul>
  </li>
  <li>Add <code class="language-plaintext highlighter-rouge">ovnkube_master_network_programming_duration_seconds</code> and <code class="language-plaintext highlighter-rouge">ovnkube_master_network_programming_ovn_duration_seconds</code> (https://github.com/ovn-org/ovn-kubernetes/pull/2878)</li>
  <li>Remove <code class="language-plaintext highlighter-rouge">ovnkube_master_skipped_nbctl_daemon_total</code> (https://github.com/ovn-org/ovn-kubernetes/pull/2707)</li>
  <li>Add <code class="language-plaintext highlighter-rouge">ovnkube_master_egress_routing_via_host</code> (https://github.com/ovn-org/ovn-kubernetes/pull/2833)</li>
  <li>Add <code class="language-plaintext highlighter-rouge">ovnkube_resource_retry_failures_total</code> (https://github.com/ovn-org/ovn-kubernetes/pull/3314)</li>
  <li>Add <code class="language-plaintext highlighter-rouge">ovs_vswitchd_interfaces_total</code> and <code class="language-plaintext highlighter-rouge">ovs_vswitchd_interface_up_wait_seconds_total</code> (https://github.com/ovn-org/ovn-kubernetes/pull/3391)</li>
  <li>Add <code class="language-plaintext highlighter-rouge">ovnkube_controller_admin_network_policies</code> and <code class="language-plaintext highlighter-rouge">ovnkube_controller_baseline_admin_network_policies</code> (https://github.com/ovn-org/ovn-kubernetes/pull/4239)</li>
  <li>Add <code class="language-plaintext highlighter-rouge">ovnkube_controller_admin_network_policies_db_objects</code> and <code class="language-plaintext highlighter-rouge">ovnkube_controller_baseline_admin_network_policies_db_objects</code> (https://github.com/ovn-org/ovn-kubernetes/pull/4254)</li>
</ul>

        </section>

        <aside id="sidebar">
          

          
            <p class="repo-owner"><a href="https://github.com/ovn-org/ovn-kubernetes">ovn-kubernetes</a> is maintained by <a href="https://github.com/ovn-org">ovn-org</a>.</p>
          

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>
        </aside>
      </div>
    </div>

  </body>
</html>
